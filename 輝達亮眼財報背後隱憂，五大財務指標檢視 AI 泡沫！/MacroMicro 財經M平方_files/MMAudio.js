"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0===a)return("string"===t?String:Number)(e);a=a.call(e,t||"default");if("object"!==_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(e,t,a){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return a}var _init=new WeakSet,_drawPlayer=new WeakSet,MMAudio=function(){function i(e,t,a,n){_classCallCheck(this,i),_classPrivateMethodInitSpec(this,_drawPlayer),_classPrivateMethodInitSpec(this,_init),this.objType=a,this.objId=n,this.gaAct="audio_".concat(n,"_pct"),this.targetDOM=$(e),this.audioPlayer=new Audio(t),this.loaded=!1,this.isPlaying=!1,this.totalSeconds=0,this.speedrate=1,this.playInterval=void 0,this.watchedPct={25:!1,50:!1,75:!1,100:!1},_classPrivateMethodGet(this,_init,_init2).call(this)}return _createClass(i,[{key:"updateFormattedTime",value:function(e,t){var a=0,e=e<60?e:(a=Math.floor(e/60),e%60),a=String(a).padStart(2,"0")+":"+String(e).padStart(2,"0");t.text(a)}},{key:"updateSliderVal",value:function(e){this.targetDOM.find(".play-slider").val(e)}}]),i}();function _init2(){var a=this;_classPrivateMethodGet(this,_drawPlayer,_drawPlayer2).call(this),this.targetDOM.find(".audio-play").on("click",function(){App.trk(a.objType,"audio_"+a.objId,"yes"),a.isPlaying?a.audioPlayer.pause():a.audioPlayer.play(),a.isPlaying=!a.isPlaying,a.targetDOM.find(".play-state-icon").toggleClass(["fa-play","fa-pause"])}),a.targetDOM.find(".audio-speed").on("click",function(){var e=$(this).data("speed");a.audioPlayer.playbackRate=parseFloat(e),a.targetDOM.find(".audio-speed").removeClass("active"),$(this).addClass("active")}),a.targetDOM.find(".play-slider").on("change",function(){a.isPlaying&&a.audioPlayer.pause();var e=parseInt($(this).val());a.audioPlayer.currentTime=e,a.updateFormattedTime(e,a.targetDOM.find(".current-duration")),a.isPlaying&&a.audioPlayer.play()}),a.targetDOM.find(".audio-volume").on("change",function(){a.audioPlayer.volume=parseFloat($(this).val())}),this.audioPlayer.addEventListener("canplay",function(){a.loaded=!0,a.totalSeconds=Math.ceil(a.audioPlayer.duration),a.updateFormattedTime(a.totalSeconds,a.targetDOM.find(".total-duration")),a.targetDOM.find(".audio-loading-icon").hide(),a.targetDOM.find(".play-slider").attr("max",a.totalSeconds)}),this.audioPlayer.addEventListener("playing",function(){a.playInterval=setInterval(function(){var t,e=Math.ceil(a.audioPlayer.currentTime);console.log(e),0<a.totalSeconds&&(t=Math.ceil(e/a.totalSeconds*100),[25,50,75].forEach(function(e){!a.watchedPct[e]&&e<=t&&(App.trk(a.objType,a.gaAct,e+"%"),a.watchedPct[e]=!0)})),a.updateFormattedTime(e,a.targetDOM.find(".current-duration")),a.updateSliderVal(e)},500)}),this.audioPlayer.addEventListener("ended",function(){a.isPlaying=!1,a.audioPlayer.currentTime=0,a.updateFormattedTime(0,a.targetDOM.find(".current-duration")),a.updateSliderVal(0),a.watchedPct[100]||(App.trk(a.objType,a.gaAct,"100%"),a.watchedPct[100]=!0),a.targetDOM.find(".play-state-icon").hasClass("fa-pause")&&a.targetDOM.find(".play-state-icon").toggleClass(["fa-play","fa-pause"])}),this.audioPlayer.addEventListener("pause",function(){clearInterval(a.playInterval)})}function _drawPlayer2(){$(this.targetDOM).append('\n        <div class="mm-audio m-0 m-lg-2 px-3 py-2 bg-white border border-primary rounded-pill">\n             <div class="d-flex align-items-center justify-content-around">\n                 <div>\n                     <button class="btn btn-white btn-sm border rounded-circle audio-play">\n                         <i class="play-state-icon fas fa-play"></i>\n                     </button>\n                 </div>\n\n                 \x3c!-- progress bar --\x3e\n                 <input type="range" min="0" step="1" value="0"\n                        class="play-slider px-2 custom-range"/>\n\n                 <div class="pl-1 small">\n                     <span class="current-duration">00:00</span> /\n                     <span class="total-duration">00:00</span>\n                 </div>\n\n                 \x3c!-- speed bar --\x3e\n                 <div class="dropdodwn px-2 d-flex justify-content-center align-items-center">\n                     <a class=dropdown-toggle" href="#" role="button" id="dropdownSpeed" data-toggle="dropdown" aria-expanded="false">\n                        <i class="fas fa-clock"></i>\n                     </a>\n\n                     <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left dropdown-menu-speed" aria-labelledby="dropdownSpeed">\n                          <a class="dropdown-item audio-speed" data-speed="0.5">0.5x</a>\n                          <a class="dropdown-item audio-speed" data-speed="0.75">0.75x</a>\n                          <a class="dropdown-item audio-speed active" data-speed="1.0">1.0x</a>\n                          <a class="dropdown-item audio-speed" data-speed="1.25">1.25x</a>\n                          <a class="dropdown-item audio-speed" data-speed="1.5">1.5x</a>\n                          <a class="dropdown-item audio-speed" data-speed="1.75">1.75x</a>\n                          <a class="dropdown-item audio-speed" data-speed="2.0">2.0x</a>\n                     </div>\n\n                 </div>\n\n                 \x3c!-- sound adjust --\x3e\n                 <div class="dropdown pl-2 w-auto d-flex justify-content-center align-items-center audio-volume-zone">\n                     <a class=dropdown-toggle" href="#" role="button" id="dropdownVolume" data-toggle="dropdown" aria-expanded="false">\n                        <i class="fas fa-volume"></i>\n                      </a>\n\n                    <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left dropdown-menu-volume" aria-labelledby="dropdownVolume">\n                        <input type="range" min="0" value="1.0" max="1" step="0.1"\n                            class="px-1 audio-volume custom-range"/>\n                    </div>\n\x3c!--                    <span class="audio-loading-icon w-25 ml-2 text-secondary">Loading...</span>--\x3e\n                 </div>\n             </div>\n         </div>\n        ')}