!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Drawer=e():t.Drawer=e()}(self,(function(){return function(){"use strict";var t,e={},i={};function a(t){var s=i[t];if(void 0!==s)return s.exports;var r=i[t]={id:t,exports:{}};return e[t](r,r.exports,a),r.exports}a.m=e,t=[],a.O=function(e,i,s,r){if(!i){var n=1/0;for(h=0;h<t.length;h++){i=t[h][0],s=t[h][1],r=t[h][2];for(var o=!0,l=0;l<i.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(t){return a.O[t](i[l])}))?i.splice(l--,1):(o=!1,r<n&&(n=r));if(o){t.splice(h--,1);var c=s();void 0!==c&&(e=c)}}return e}r=r||0;for(var h=t.length;h>0&&t[h-1][2]>r;h--)t[h]=t[h-1];t[h]=[i,s,r]},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={174:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,r,n=i[0],o=i[1],l=i[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var h=l(a)}for(e&&e(i);c<n.length;c++)r=n[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(h)},i=self.webpackChunkmacromicro_www=self.webpackChunkmacromicro_www||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var s={};a.d(s,{default:function(){return b}});var r,n=Highcharts,o=a.n(n),l=class{constructor(t,e,i){this.conf={},this.domID=t,this.chartData=e,this.seriesData=i}draw(){return o().chart(this.domID,this.conf)}setChart(){return console.log("Override it, or no affect."),this}setTitle(){let t=this.chartData["name_"+App.lang];return-1!==[Drawer.CHART_TYPE_QUOTE_COLUMN,Drawer.CHART_TYPE_QUOTE_BAR].indexOf(this.chartData.type)&&(document.body.classList.contains("page-market")||document.body.classList.contains("page-quickie")||document.body.classList.contains("page-toolbox"))&&(Drawer.isPhone&&(t+="<br>"),t+=" ("+this.chartData.date_start+" ~ "+this.chartData.date_end+")"),this.conf.title={text:t},this}setSubTitle(){let t=this.chartData.user,e="MacroMicro.me";return e+=t?" | "+t.name:" | MacroMicro",this.conf.subtitle={text:e},this}setTooltip(){return this.conf.tooltip={valueDecimals:this.chartData.chart_config.valueDecimals},this}setSeries(){return this.conf.series=[],this}setXAxis(){return this.conf.xAxis={},this}setYAxis(){return this.conf.yAxis=[],this}setPlotOptions(){return this.conf.plotOptions={},this}setLegend(){return this.conf.legend={enabled:!1},this}setNavigator(){return this.conf.navigator={enabled:!1},this}setRangeSelector(){return this.conf.rangeSelector={enabled:!1},this}setExtraOpts(){let t=$("#"+this.domID),e=void 0!==t.data("opts")&&t.data("opts");return!1!==e&&$.extend(!0,this.conf,e),this}setNewestValueLabel(){return this.conf.plotOptions.series.events={hide:function(t){"showNewestValues"in window&&window.showNewestValues&&Drawer.genNewestValuesLabel(t.target.chart,!0)},show:function(t){"showNewestValues"in window&&window.showNewestValues&&Drawer.genNewestValuesLabel(t.target.chart,!0)}},this}formatSeries(t="theater",e="D",i){let a=i.length,s=[];if("thumb"===t&&"D"===e&&a>=1200){let t;switch(a){case a>=2400:t=3;break;case a>=3600:t=4;break;case a>=5e3:t=5;break;default:t=2}for(let e=0;e<i.length;e++){let a=i[e][0],r=i[e][1];e%t==0&&(7===a.length&&(a+="-01"),s.push([App._parseDate(a),parseFloat(r)]))}}else for(let t=0;t<i.length;t++){let e=i[t][0],a=i[t][1];7===e.length&&(e+="-01"),s.push([App._parseDate(e),parseFloat(a)])}return s}_coerceValue(t){let e;return"string"==typeof t?""!==t?(e=parseFloat(t),isNaN(e)&&(e=null)):e=null:e=t,e}getXDateFormat(t){let e;switch(t){case"D":case"W":default:e="%A, %d %b %Y";break;case"M":e="%B %Y";break;case"Q":e="Q%q %Y";break;case"H":e="H%c %Y";break;case"Y":e="%Y"}return e}getPlotBands(){let t=Drawer.recPlotBands;return"/potus-47-donald-trump"===location.pathname?t=[{startDate:"1993-01-20",endDate:"2001-01-20",colorRGBA:"rgba(59, 175, 218, 0.1)"},{startDate:"2001-01-20",endDate:"2009-01-20",colorRGBA:"rgba(233, 87, 63, 0.1)"},{startDate:"2009-01-20",endDate:"2017-01-20",colorRGBA:"rgba(59, 175, 218, 0.1)"},{startDate:"2017-01-20",endDate:"2021-01-20",colorRGBA:"rgba(233, 87, 63, 0.1)"},{startDate:"2021-01-20",endDate:"2025-01-20",colorRGBA:"rgba(59, 175, 218, 0.1)"},{startDate:"2025-01-20",endDate:"2029-01-20",colorRGBA:"rgba(233, 87, 63, 0.1)"}].map((function(t){let e=new Date(t.startDate).getTime(),i=new Date(t.endDate).getTime();return{color:t.colorRGBA,from:e,to:i}})):Array.isArray(this.chartData.chart_config.customPlotBands)&&this.chartData.chart_config.customPlotBands.length>0&&(t=this.chartData.chart_config.customPlotBands.map((function(t){let e=new Date(t.startDate).getTime(),i=new Date(t.endDate).getTime();return!t.hasOwnProperty("colorRGBA")&&t.hasOwnProperty("color")&&(t.colorRGBA=Drawer.getRGBA(t.color,t.opacity)),{color:t.colorRGBA,from:e,to:i}}))),"hidePlotBands"in window&&window.hidePlotBands?[]:t}},c=class extends l{constructor(t,e,i){super(t,e,i),this.yIndices=[],this.iterOrder=[]}draw(){return this.setChart().setTitle().setSubTitle().setTooltip().setXAxis().setYAxis().setRangeSelector().setPlotOptions().setNavigator().setLegend().setExtraOpts().setNewestValueLabel(),this.chartData.type===Drawer.CHART_TYPE_LINE_RANGE?this.setRangeSeries():this.setSeries(),this.chartData.type===Drawer.CHART_TYPE_LINE_STOCK?o().stockChart(this.domID,this.conf):o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={zooming:{type:"xy",resetButton:{position:{x:0,y:-36}}}},this}setTooltip(){if(super.setTooltip(),this.chartData.chart_config.hasOwnProperty("rangeChartOpt")&&!1===this.chartData.chart_config.rangeChartOpt.showLegendAvgInfo){let t=this.chartData.chart_config.valueDecimals,e=this.getXDateFormat(this.chartData.chart_config.seriesConfigs[0].freq);this.conf.tooltip={useHTML:!0,formatter:function(){let i=o().dateFormat(e,+this.x),a=this.point.low.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t}),s=this.point.high.toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t});return'<span style="font-size: 0.75em;">'+i+'</span><br/><div style="margin-right: 2px; border-radius: 50%; display: inline-block; height: 10px; width: 10px; background-color: '+this.points[0].color+';"></div>'+this.points[0].series.name+": <b>"+a+" - "+s+"</b>"}}}return this}setXAxis(){if(this.conf.xAxis=[{crosshair:!0,type:"datetime",plotBands:this.getPlotBands(),minTickInterval:864e5}],""!==this.chartData.chart_config.xbaselines){let t=this.chartData.chart_config.xbaselines.toString().split(","),e=[];for(let i=0;i<t.length;i++)!1!==Drawer.datePattern.test(t[i])&&e.push({color:"#999999",width:2,value:App._parseDate(t[i]),zIndex:5,dashStyle:"Dash"});e.length>0&&(this.conf.xAxis[0].plotLines=e)}return this}setYAxis(){if(this.conf.yAxis=[],-1!==[Drawer.CHART_TYPE_LINE_RETURN,Drawer.CHART_TYPE_LINE_RANGE].indexOf(this.chartData.type))for(let t=0;t<this.chartData.chart_config.seriesConfigs.length;t++)this.chartData.type===Drawer.CHART_TYPE_LINE_RETURN?this.chartData.chart_config.seriesConfigs[t].unitlabel="Percent":this.chartData.chart_config.seriesConfigs[t].unitlabel=Drawer.getYLabel(this.chartData.type,this.chartData.chart_config,t),this.chartData.chart_config.seriesConfigs[t].y_position=1,this.chartData.chart_config.seriesConfigs[t].yoppo=0,this.chartData.chart_config.seriesConfigs[t].y_reverse=0,this.chartData.chart_config.seriesConfigs[t].ytype="linear";let t=[],e=[];for(let t=0;t<this.chartData.chart_config.seriesConfigs.length;t++){let i=this.chartData.chart_config.seriesConfigs[t].y_position;-1===e.indexOf(i)&&e.push(i),this.iterOrder.push({originIndex:t,position:i})}this.iterOrder.sort((function(t,e){return t.position<e.position?-1:1}));let i={},a={1:{L:[],R:[]},2:{L:[],R:[]},3:{L:[],R:[]},4:{L:[],R:[]}};for(let s=0;s<this.iterOrder.length;s++){let r,n,o=this.iterOrder[s].originIndex,l=this.chartData.chart_config.seriesConfigs[o],c=Drawer.getYLabel(this.chartData.type,this.chartData.chart_config,o),h=l.hasOwnProperty("ytype")?l.ytype:"linear",p="linear"===h?1:0,d=c+"_"+l.y_position+"_"+l.yoppo+"_"+l.y_reverse+"_"+h;if(0===this.conf.yAxis.length){if(n={title:{text:c},reversed:1===l.y_reverse,opposite:1===l.yoppo,crosshair:!0,margin:0,min:this._coerceValue(l.ymin),max:this._coerceValue(l.ymax),gridLineWidth:p,type:h},e.length>1){let t=100/e.length;n.top="0%",n.height=t+"%",n.showFirstLabel=!1,n.resize={enabled:!0},i[l.y_position]=0,0===l.yoppo?a[l.y_position].L.push(d):a[l.y_position].R.push(d)}this.conf.yAxis.push(n),t.push(d),r=0}else{for(let e=0;e<t.length;e++)if(-1!==t.indexOf(d)){r=t.indexOf(d);break}if(void 0===r){let o=0===l.yoppo?-15:15;if(r=this.conf.yAxis.length,n={title:{text:c},reversed:1===l.y_reverse,opposite:1===l.yoppo,crosshair:!0,labels:{x:o},min:this._coerceValue(l.ymin),max:this._coerceValue(l.ymax),gridLineWidth:p,type:h},e.length>1){0===l.yoppo&&a[l.y_position].L.length>0&&(o-=50*a[l.y_position].L.length),1===l.yoppo&&a[l.y_position].R.length>0&&(o+=50*a[l.y_position].R.length);let t=100/e.length;if(i.hasOwnProperty(l.y_position))n.top=i[l.y_position]+"%";else{let e=t*Object.keys(i).length;n.top=e+"%",i[l.y_position]=e}n.height=t+"%",n.offset=0,n.showFirstLabel=!1,n.labels.x=o,n.resize={enabled:s!==this.iterOrder.length-1}}0===l.yoppo&&-1===a[l.y_position].L.indexOf(d)&&a[l.y_position].L.push(d),1===l.yoppo&&-1===a[l.y_position].R.indexOf(d)&&a[l.y_position].R.push(d),this.conf.yAxis.push(n),t.push(d)}}if(""!==l.ybaselines){let t=l.ybaselines.split(","),e=[];for(let i=0;i<t.length;i++){let a=parseFloat(t[i]);isNaN(a)||e.push({color:"#999999",width:2,value:parseFloat(t[i]),zIndex:5,dashStyle:"Dash"})}e.length>0&&(this.conf.yAxis[r].plotLines=e)}this.yIndices.push(r)}return this}setPlotOptions(){return this.conf.plotOptions={series:{}},this}setLegend(){return this.conf.legend={enabled:!0,itemStyle:{fontSize:Drawer.isPhone?"10.5px":"14px"},itemHiddenStyle:{textDecoration:"None",color:"#cccccc"}},this}setNavigator(){return this.chartData.type===Drawer.CHART_TYPE_LINE_STOCK&&(this.conf.navigator={height:20}),this}setRangeSeries(){if(this.conf.series=[],this.seriesData.length<2)return this;let t={};for(let e=0;e<this.seriesData[0].length;e++)t[this.seriesData[0][e][0]]=[this.seriesData[0][e][1]];for(let e=0;e<this.seriesData[1].length;e++)this.seriesData[1][e][0]in t&&t[this.seriesData[1][e][0]].push(this.seriesData[1][e][1]);if(Object.keys(t).length>0){let e=[];for(let i in t)2===t[i].length&&e.push([App._parseDate(i),parseFloat(t[i][0]),parseFloat(t[i][1])]);this.conf.series.push({name:this.chartData.chart_config.seriesConfigs[0]["name_"+App.lang],data:e,type:"arearange",lineWidth:0,color:this.chartData.chart_config.seriesConfigs[0].color,fillOpacity:.3,zIndex:0})}if(this.seriesData.length>2){let t=[];for(let e=0;e<this.seriesData[2].length;e++)t.push([App._parseDate(this.seriesData[2][e][0]),parseFloat(this.seriesData[2][e][1])]);this.conf.series.push({name:this.chartData.chart_config.seriesConfigs[2]["name_"+App.lang],data:t,zIndex:1,color:this.chartData.chart_config.seriesConfigs[2].color})}return this}setSeries(){var t;this.conf.series=[];let e,i=1===$(".chart-theater #"+this.domID).length?"theater":"thumb",a=document.getElementById(this.domID).dataset;a.hasOwnProperty("visibles")&&!isNaN(parseInt(a.visibles))&&(e=parseInt(a.visibles));let s={};for(let a=0;a<this.iterOrder.length;a++){let r=this.iterOrder[a].originIndex,n=this.chartData.chart_config.seriesConfigs[r],o=[];if(0===this.seriesData[r].length)continue;if(s[n.freq]=!0,o=this.formatSeries(i,n.freq,this.seriesData[r]),void 0!==n.inverse&&1===n.inverse)for(let t=0;t<o.length;t++)o[t][1]=1/o[t][1];let l="column"===n.lineType?"column":"line",c=n.line_width?"number"==typeof n.line_width?n.line_width:parseInt(n.line_width):2,h=n.color?n.color:Drawer.colorOptions[a],p=null!=(t=n.dashStyle)?t:"Solid",d={xDateFormat:this.getXDateFormat(n.freq)},f=n.stats.map((function(t){return"string"==typeof t.stat_id?parseInt(t.stat_id):t.stat_id}));Array.isArray(App.data.showDateList)&&f.some((t=>App.data.showDateList.includes(t)))&&(d.pointFormatter=function(){return null}),"line"===l?this.conf.series.push({tooltip:d,index:r,name:n["name_"+App.lang],type:"line",yAxis:this.yIndices[a],zIndex:10+a,color:h,lineWidth:c,data:o,visible:!e||a+1<=e,dashStyle:p}):this.conf.series.push({tooltip:d,index:r,name:n["name_"+App.lang],type:"column",yAxis:this.yIndices[a],zIndex:a,color:h,data:o,visible:!e||a+1<=e,dashStyle:p})}return Object.keys(s).length>1&&(this.conf.tooltip.shared=!1),this}setRangeSelector(){var t;this.conf.rangeSelector={enabled:!0,inputEnabled:!1,buttons:Drawer.rangeSelectors,buttonSpacing:0,buttonTheme:{fill:"none",style:{color:"#666666"},states:{select:{fill:"#50e3c2",style:{color:"#333333"}}}},selected:null!=(t=this.chartData.chart_config.defaultRangeIdx)?t:0};let e=this;for(let t=0;t<this.conf.rangeSelector.buttons.length;t++)this.conf.rangeSelector.buttons[t].events={click:function(){let t=$("#"+e.domID).highcharts(),i=this.text;window.hasOwnProperty("maxMinOpt")&&t instanceof o().Chart&&Drawer.appendMaxMinLines(t,i)}};return this}},h=class extends l{constructor(t,e,i){super(t,e,i),this.xAxisCategories=[]}draw(){return this.setChart().setTitle().setSubTitle().setXAxis().setYAxis().setSeries().setTooltip().setRangeSelector().setPlotOptions().setNavigator().setLegend().setExtraOpts(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:2===this.chartData.type?"bar":"column"},this}setTooltip(){super.setTooltip();let t=this;return this.conf.tooltip.formatter=function(){let e=this.x+"<br>";for(let i=0;i<this.points.length;i++){let a=this.points[i].color,s=this.points[i].y.toFixed(t.chartData.chart_config.valueDecimals),r=t.xAxisCategories.indexOf(this.x.toString()),n=Drawer.getYLabel(t.chartData.type,t.chartData.chart_config,r,"suffix");e+=`<span style="color: ${a};">&#9679;</span> `+this.points[i].series.name+": <b>"+s+"</b> "+n+"<br>"}return e},this}setXAxis(){return this.xAxisCategories=this.chartData.chart_config.seriesConfigs.map((function(t){return t["name_"+App.lang]})),this.conf.xAxis={type:"category",categories:this.xAxisCategories,title:{text:null}},this}setYAxis(){return this.conf.yAxis={title:{text:""},plotLines:[{color:"#999999",width:1,value:0,zIndex:5,dashStyle:"Dash"}]},this.chartData.chart_config.seriesConfigs.length>0&&""!==this.chartData.chart_config.seriesConfigs[0].unitlabel&&(this.conf.yAxis.title.text=this.chartData.chart_config.seriesConfigs[0].unitlabel),this}setPlotOptions(){let t=2===this.chartData.type?"bar":"column";return this.conf.plotOptions={},this.conf.plotOptions[t]={dataLabels:{enabled:!0,allowOverlap:!0,format:`{point.y:.${this.chartData.chart_config.valueDecimals}f}`}},this}setLegend(){return this.conf.legend={enabled:!0,itemHiddenStyle:{textDecoration:"None",color:"#cccccc"}},this.chartData.chart_config.sortBarChart&&(this.conf.legend.symbolHeight=0,this.conf.legend.symbolWidth=0),this}setSeries(){this.conf.series=[];let t=[];for(let e=0;e<this.seriesData.length;e++){let i={};for(let t=0;t<this.seriesData[e].length;t++){let a=this.seriesData[e][t];i[a[0]]=a[1]}t.push(i)}let e=[];"recentFixedDates"in this.chartData.chart_config&&this.chartData.chart_config.recentFixedDates.length>0&&(e=Array.from(this.chartData.chart_config.recentFixedDates));let i=Object.keys(t[0]).sort((function(t,e){return t>e?-1:1}));for(let a=0;a<i.length&&!(e.length>=3);a++){let s=!0,r=i[a];for(let e=0;e<t.length;e++)if(!t[e].hasOwnProperty(r)){s=!1;break}!0===s&&e.push(r)}e.sort((function(t,e){return t>e?-1:1})),!0===this.chartData.chart_config.sortBarChart&&e.splice(1,2);let a=this,s=this.chartData.chart_config.seriesConfigs[0].freq;if(e.forEach((function(e,i){let r=[];t.forEach((function(t){let i=e in t?parseFloat(t[e]):null;r.push(i)})),!0===a.chartData.chart_config.sortBarChart?a.conf.series.push({type:2===a.chartData.type?"bar":"column",color:Drawer.colorOptions[i],name:Drawer.getDateByFreq(s,e),data:r.map((function(t){return{y:t,color:t>=0?"#199b7e":"#f96868",pointWidth:25}}))}):a.conf.series.push({type:2===a.chartData.type?"bar":"column",color:Drawer.colorOptions[i],name:Drawer.getDateByFreq(s,e),data:r,visible:i<2})})),!0===this.chartData.chart_config.sortBarChart){let t=this.conf.series[0];for(let e=0;e<t.data.length;e++)t.data[e].origin_index=e;let e={};for(let i=0;i<t.data.length;i++)e[t.data[i].y+"-"+i]=i;let i=[];t.data.sort((function(t,e){return t.y>e.y?-1:1}));for(let a=0;a<t.data.length;a++){let s=t.data[a].origin_index;i.push(e[t.data[a].y+"-"+s])}let a=this.conf.xAxis,s=[];for(let t=0;t<a.categories.length;t++)s.push(a.categories[i[t]]);a.categories=s}else this.conf.series=this.conf.series.reverse();return this}},p=class extends l{constructor(t,e,i){super(t,e,i)}draw(){return this.setChart().setTitle().setSubTitle().setXAxis().setYAxis().setSeries().setTooltip().setPlotOptions().setRangeSelector().setNewestValueLabel(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:this.chartData.type===Drawer.CHART_TYPE_STACKED_COLUMN?"column":"bar"},this}setXAxis(){return this.conf.xAxis={crosshair:!0,type:"datetime",plotBands:this.getPlotBands(),minTickInterval:864e5},this}setYAxis(){let t=this.chartData.chart_config.seriesConfigs[0],e=Drawer.unitOptions[t.u].name;if(""!==t.unitlabel.trim()&&(e=t.unitlabel),this.conf.yAxis={title:{text:e}},"number"==typeof t.ymin&&(this.conf.yAxis.min=t.ymin),"number"==typeof t.ymax&&(this.conf.yAxis.max=t.ymax),""!==t.ybaselines){let e=t.ybaselines.split(","),i=[];for(let t=0;t<e.length;t++){let a=parseFloat(e[t]);isNaN(a)||i.push({color:"#999999",width:2,value:parseFloat(e[t]),zIndex:5,dashStyle:"Dash"})}i.length>0&&(this.conf.yAxis.plotLines=i)}return this}setTooltip(){let t=this.chartData.chart_config.valueDecimals;return this.conf.tooltip={useHTML:!0,valueDecimals:t},this}setPlotOptions(){return this.conf.plotOptions={series:{}},this.chartData.type===Drawer.CHART_TYPE_STACKED_COLUMN?this.conf.plotOptions.column={stacking:"normal",borderWidth:0}:this.conf.plotOptions.series={stacking:"normal",borderWidth:0},this}setSeries(){if(this.chartData.chart_config.seriesConfigs.length<1)return this;this.conf.series=[];let t=[];for(let e=0;e<this.seriesData.length;e++){let i={};for(let t=0;t<this.seriesData[e].length;t++)i[this.seriesData[e][t][0]]=this.seriesData[e][t][1];t.push(i)}let e=/^(19|20)[0-9]{2}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/,i="DESC";e.test(this.chartData.date_start)&&!e.test(this.chartData.date_end)&&(i="ASC");let a=Object.keys(t[0]).sort((function(t,e){return"DESC"===i?t>e?-1:1:t>e?1:-1})),s=[];for(let e=0;e<a.length&&!(s.length>=400);e++){let i=!0,r=a[e];for(let e=0;e<t.length;e++)if(!t[e].hasOwnProperty(r)){i=!1;break}!0===i&&s.push(r)}let r=this,n={xDateFormat:this.getXDateFormat(this.chartData.chart_config.seriesConfigs[0].freq)},o=!1,l={};t.forEach((function(t,e){let i=[];s.forEach((function(e,a){if(t.hasOwnProperty(e)){let a=App._parseDate(e),s=parseFloat(t[e]);i.push([a,s]),a in l||(l[a]=0),l[a]+=s}})),i.sort((function(t,e){return t[0]<e[0]?-1:1}));let a=r.chartData.chart_config.seriesConfigs[e],c=a.stats.map((function(t){return"string"==typeof t.stat_id?parseInt(t.stat_id):t.stat_id})),h=Array.isArray(App.data.showDateList)&&c.some((t=>App.data.showDateList.includes(t))),p=Object.assign({},n);h&&(o=!0,p.pointFormatter=function(){return null}),r.conf.series.push({type:r.chartData.type===Drawer.CHART_TYPE_STACKED_COLUMN?"column":"bar",tooltip:p,name:a["name_"+App.lang],data:i,color:a.color?a.color:Drawer.colorOptions[e]})}));let c=[];for(let t in l)c.push([parseInt(t),l[t]]);return c.sort((function(t,e){return t[0]<e[0]?-1:1})),o&&(n.pointFormatter=function(){return null}),this.conf.series.push({type:"line",tooltip:n,name:"Total",data:c,color:"#000000"}),this}setRangeSelector(){var t;return this.conf.rangeSelector={enabled:!0,inputEnabled:!1,buttons:Drawer.rangeSelectors,buttonSpacing:0,buttonTheme:{fill:"none",style:{color:"#666666"},states:{select:{fill:"#50e3c2",style:{color:"#333333"}}}},selected:null!=(t=this.chartData.chart_config.defaultRangeIdx)?t:0},this}},d=class extends l{constructor(t,e,i){var a;super(t,e,i),this.orderedData=[],this.smallScreen=window.innerWidth<400;let s=e.chart_config.seriesConfigs;for(let t=0;t<s.length;t++){let e=s[t]["name_"+App.lang],r=null,n=i[t];if(n.length>1){let e=parseFloat(n[0][1]),i=parseFloat(n[1][1]);s[t].inverse&&1===s[t].inverse&&(e=1/e,i=1/i),r="pch"===(null!=(a=this.chartData.chart_config.return_opn)?a:"pch")?0!==e?(i-e)/e*100:0:i-e}this.orderedData.push({name:e,quoteChange:r})}this.orderedData.sort((function(t,e){return t.quoteChange<e.quoteChange?-1:1}))}draw(){return this.setChart().setTitle().setSubTitle().setTooltip().setXAxis().setYAxis().setSeries().setRangeSelector().setPlotOptions().setLegend().setExtraOpts(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:"column"},this}setXAxis(){let t=this.orderedData.map((function(t){return t.name}));return this.conf.xAxis={type:"category",minTickInterval:null,labels:{rotation:"en"===App.lang?-65:-45,style:{fontSize:this.smallScreen?"10px":"12px"}},categories:t},this}setYAxis(){return this.conf.yAxis={title:{text:"chg"===this.chartData.chart_config.return_opn?"Number":"Percent"},plotLines:[{color:"#999999",width:1,value:0,zIndex:5,dashStyle:"Dash"}]},this}setPlotOptions(){let t=this.orderedData.map((function(t){return t.name}));return this.conf.plotOptions={column:{dataLabels:{enabled:!0,style:{fontSize:this.smallScreen?"8px":t.length<=10?"12px":"9px"},format:"chg"===this.chartData.chart_config.return_opn?"{y:.2f}":"{y:.2f}%"}}},this}setLegend(){return this.conf.legend={enabled:!1},this}setTooltip(){return this.conf.tooltip={valueDecimals:this.chartData.chart_config.valueDecimals,valueSuffix:"chg"===this.chartData.chart_config.return_opn?"":"%"},this}setSeries(){let t=this,e=this.orderedData.map((function(t){return t.quoteChange}));return this.conf.series=[],this.conf.series.push({type:"column",colorAxis:0,name:App.__("toolbox:quote-change"),data:e.map((function(e){let i;return i="europe"===t.chartData.chart_config.quoteChangeColors?e>=0?"#199b7e":"#f96868":e>=0?"#f96868":"#199b7e",{y:e,color:i,pointWidth:25}}))}),this}},f=class extends l{constructor(t,e,i){var a;super(t,e,i),this.orderedData=[];let s=e.chart_config.seriesConfigs;for(let t=0;t<s.length;t++){let e=s[t]["name_"+App.lang],r=null,n=i[t];if(n.length>1){let e=parseFloat(n[0][1]),i=parseFloat(n[1][1]);s[t].inverse&&1===s[t].inverse&&(e=1/e,i=1/i),r="pch"===(null!=(a=this.chartData.chart_config.return_opn)?a:"pch")?0!==e?(i-e)/e*100:0:i-e}this.orderedData.push({name:e,quoteChange:r})}this.orderedData.sort((function(t,e){return t.quoteChange<e.quoteChange?-1:1}))}draw(){return this.setChart().setTitle().setSubTitle().setTooltip().setXAxis().setYAxis().setSeries().setRangeSelector().setPlotOptions().setLegend().setExtraOpts(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:"bar"},this}setXAxis(){let t=this.orderedData.map((function(t){return t.name}));return this.conf.xAxis={type:"category",title:{text:null},gridLineWidth:1,lineWidth:0,categories:t},this}setYAxis(){return this.conf.yAxis={title:{text:"chg"===this.chartData.chart_config.return_opn?"Number":"Percent",align:"high"},labels:{overflow:"justify"},gridLineWidth:0,plotLines:[{color:"#999999",width:1,value:0,zIndex:5,dashStyle:"Dash"}]},this}setPlotOptions(){return this.conf.plotOptions={bar:{dataLabels:{enabled:!0,format:"chg"===this.chartData.chart_config.return_opn?"{y:.2f}":"{y:.2f}%"},groupPadding:.1}},this}setLegend(){return this.conf.legend={enabled:!1},this}setTooltip(){return this.conf.tooltip={valueDecimals:this.chartData.chart_config.valueDecimals,valueSuffix:"chg"===this.chartData.chart_config.return_opn?"":"%"},this}setSeries(){let t=this,e=this.orderedData.map((function(t){return t.quoteChange}));return this.conf.series=[],this.conf.series.push({type:"bar",colorAxis:0,name:App.__("toolbox:quote-change"),data:e.map((function(e){let i;return i="europe"===t.chartData.chart_config.quoteChangeColors?e>=0?"#199b7e":"#f96868":e>=0?"#f96868":"#199b7e",{y:e,color:i,pointWidth:25}}))}),this}},u=class extends l{constructor(t,e,i){super(t,e,i)}draw(){return this.chartData.chart_config.seriesConfigs.length>0&&this.setChart().setTitle().setSubTitle().setTooltip().setXAxis().setYAxis().setSeries().setRangeSelector().setPlotOptions().setLegend().setExtraOpts().setNewestValueLabel(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:"line",spacingBottom:30},this}setXAxis(){return this.conf.xAxis={type:"datetime",crosshair:!0,minTickInterval:null,labels:{formatter:function(){let t="string"==typeof this.value?parseInt(this.value):this.value;return o().dateFormat("%b",t)}}},"W"===this.chartData.chart_config.seriesConfigs[0].freq&&(this.conf.xAxis.plotBands=[{color:"rgba(200,248,248,0.5)",from:1577808e6,to:15856704e5,zIndex:0},{color:"rgba(200,248,248,0.5)",from:15935328e5,to:16014816e5,zIndex:0}]),this}setYAxis(){let t=this.chartData.chart_config.seriesConfigs[0],e="ratio"===t.season_mode?"Percent":Drawer.unitOptions[t.u].name;return this.conf.yAxis={title:{text:e}},this}setSeries(){if(0===this.seriesData.length||0===this.seriesData[0].length)return this;let t=this.chartData.chart_config.seriesConfigs[0].stats.map((function(t){return"string"==typeof t.stat_id?parseInt(t.stat_id):t.stat_id})),e={};Array.isArray(App.data.showDateList)&&t.some((t=>App.data.showDateList.includes(t)))&&(e.pointFormatter=function(){return null});let i=this._getFormattedData(this.seriesData[0]),a=(new Date).getFullYear(),s=0,r=["#7d5b4f","#57c7d4","#926dde","#F44582","#37bc9b","#70ca63","#f6bb42","#e9573f","#3bafda","#000000"];this.conf.series=[];for(let t in i)i.hasOwnProperty(t)&&(this.conf.series.push({color:r[s],tooltip:e,type:"line",name:t,data:i[t],visible:parseInt(t)>=a-4,lineWidth:Object.keys(i).length-1===s?3:2}),s++);return this}setPlotOptions(){return this.conf.plotOptions={series:{}},"D"!==this.chartData.chart_config.seriesConfigs[0].freq&&(this.conf.plotOptions.series={marker:{enabled:!0,symbol:"circle"}}),this}setLegend(){return this.conf.legend={y:15,itemHiddenStyle:{textDecoration:"None",color:"#cccccc"}},this}setTooltip(){let t="M"===this.chartData.chart_config.seriesConfigs[0].freq?"%b":"%m-%d";return this.conf.tooltip={xDateFormat:t,valueDecimals:this.chartData.chart_config.valueDecimals},this}_getFormattedData(t){let e=this,i={};t.forEach((function(t){let a=new Date(t[0]),s=a.getFullYear();if(a.setFullYear(2020),i.hasOwnProperty(s)||(i[s]=[]),"W"===e.chartData.chart_config.seriesConfigs[0].freq){let t=a.getDay(),e=a.getDate();a.setDate(e-t)}i[s].push([a.getTime(),parseFloat(t[1])])}));for(let t in i)i[t].sort((function(t,e){return t[0]<e[0]?-1:1}));return i}},g=class extends l{constructor(t,e,i){super(t,e,i),this.scatterSeries=[],this.scatterDates=[],this.nowIndex=0,this.delta=0,this.playing=1,this.tailLength=11,this.period=400}draw(){return this.setChart().setTitle().setSubTitle().setTooltip().setXAxis().setYAxis().setSeries().setRangeSelector().setPlotOptions().setNavigator().setLegend().setExtraOpts(),o().chart(this.domID,this.conf)}setChart(){return this.conf.chart={type:"scatter",animation:!1,margin:null,plotBackgroundImage:"/img/ui/eco-cycle-bg.png"},this}setXAxis(){return this.conf.xAxis={type:"linear",gridLineWidth:1,tickInterval:2,max:4,min:-4,labels:{enabled:!1},tickWidth:0,plotLines:[{value:0,width:3,color:"#d8d8d8"}]},this}setYAxis(){return this.conf.yAxis={title:null,tickInterval:2,max:4,min:-4,labels:{enabled:!1},plotLines:[{value:0,width:3,color:"#d8d8d8"}]},this}setPlotOptions(){return this.conf.plotOptions={series:{lineWidth:3,marker:{enabled:!1}}},this}setSeries(){this.conf.series=[];let t=this.chartData.chart_config.seriesConfigs[0],e=this.seriesData[0];for(let t=0;t<e.length;t++){let i=e[t];this.scatterDates.push(i[0].substring(0,7)),this.scatterSeries.push([parseFloat(i[1]),parseFloat(i[2])])}return this.conf.series.push({type:"scatter",name:t["name_"+App.lang],color:Drawer.colorOptions[0],data:[],showInLegend:!0,enableMouseTracking:!1}),this.conf.series.push({type:"scatter",color:Drawer.colorOptions[0],data:[this.scatterSeries[0][1],this.scatterSeries[0][2]],marker:{enabled:!0,symbol:"circle",radius:4,lineWidth:2,lineColor:Drawer.colorOptions[0],fillColor:"#FFFFFF"},showInLegend:!1,enableMouseTracking:!1}),this}setExtraOpts(){this.conf.subtitle.text=this.scatterDates[0];let t=this,e=[],i=[];function a(a){if(void 0===t.scatterDates[t.nowIndex])return t.playing=0,void $(`#${t.domID} .cyclic-chart-toolbar .btn-toggle-play`).removeClass("playing");for(let a=0,s=e.length;a<s;a++){if(0!==t.delta)e[a].setData([]);else{let i=e[a].data.length>=t.tailLength;e[a].addPoint([t.scatterSeries[t.nowIndex][0],t.scatterSeries[t.nowIndex][1]],!1,i,!1)}e[a].update(!0,!0),i[a].data[0].update([t.scatterSeries[t.nowIndex][0],t.scatterSeries[t.nowIndex][1]],!0,!1)}$(`#${t.domID}-cyclic-chart-toolbar .progbar span`).css("width",100*(t.nowIndex+1)/t.scatterDates.length+"%"),$(`#${t.domID}-cyclic-chart-toolbar .prog-slider`).val(t.nowIndex+1),a.setSubtitle({text:t.scatterDates[t.nowIndex]})}let s=`\n            <div id="${t.domID}-cyclic-chart-toolbar" class="my-2 chart-toolbar cyclic-chart-toolbar">\n                 <div class="prog-div" style="padding: 0 8px;">\n                    <input class="prog-slider" type="range" min="0" max="${t.scatterDates.length-1}" value="0" step="1" style="width: 100%;">\n                </div>\n                \n                <button class="btn btn-light btn-back-fast"><i class="fa fa-fast-backward"></i></button>\n                <button class="btn btn-light btn-back"><i class="fa fa-step-backward"></i></button>\n                <button class="btn btn-light btn-toggle-play playing"><i class="fa fa-pause"></i><i class="fa fa-play"></i></button>\n                <button class="btn btn-light btn-forward"><i class="fa fa-step-forward"></i></button>\n                <button class="btn btn-light btn-forward-fast"><i class="fa fa-fast-forward"></i></button>\n            </div>`;return $(`#${t.domID}`).after(s),this.conf.chart.events={load:function(){let s=this;for(let t=0,a=this.series.length;t<a;t++)t%2==0?e.push(this.series[t]):i.push(this.series[t]);let r=`cyclic-chart-interval_${t.domID}`;void 0!==App[r]&&clearInterval(App[r]),App[r]=setInterval((function(){t.playing&&(a(s),t.delta=0,t.nowIndex++)}),t.period),$(document).on("change",`#${t.domID}-cyclic-chart-toolbar .prog-slider`,(function(){let e=t.playing;e&&(t.playing=0);let i=$(this).val();Array.isArray(i)&&(i=i[0]),t.nowIndex="number"!=typeof i?parseInt(i):i,t.delta=-1,s.setTitle(null,{text:t.scatterDates[t.nowIndex]}),a(s),e&&(t.playing=1)})),$(document).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-toggle-play`,(function(e){e.preventDefault(),1===t.playing?($(this).removeClass("playing"),t.playing=0):($(this).addClass("playing"),t.nowIndex>=t.scatterDates.length-1&&(t.nowIndex=1,t.delta=-1),t.playing=1)})).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-replay`,(function(e){e.preventDefault(),t.nowIndex=1,t.delta=-1;let i=$(`#${t.domID}-cyclic-chart-toolbar .btn-toggle-play`);!1===i.hasClass("playing")&&i.trigger("click")})).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-back-fast`,(function(e){e.preventDefault(),t.nowIndex=Math.max(1,t.nowIndex-=61),t.delta=-1,a(s)})).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-back`,(function(e){e.preventDefault(),t.nowIndex=Math.max(1,t.nowIndex-=13),t.delta=-1,a(s)})).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-forward`,(function(e){e.preventDefault(),t.nowIndex=Math.min(t.scatterDates.length-1,t.nowIndex+=11),t.delta=1,a(s)})).on("click",`#${t.domID}-cyclic-chart-toolbar .btn-forward-fast`,(function(e){e.preventDefault(),t.nowIndex=Math.min(t.scatterDates.length-1,t.nowIndex+=59),t.delta=1,a(s)}))}},this}};window.hasOwnProperty("Highcharts")&&(r=o()).addEvent(r.Chart,"load",(function(){!0!==window.hideWatermark&&m.appendWaterMark(this),"showNewestValues"in window&&!0===window.showNewestValues&&m.genNewestValuesLabel(this)}));const m={CHART_TYPE_LINE:1,CHART_TYPE_LINE_STOCK:10,CHART_TYPE_RECENT_BAR:2,CHART_TYPE_RECENT_COLUMN:20,CHART_TYPE_QUOTE_COLUMN:3,CHART_TYPE_QUOTE_BAR:30,CHART_TYPE_SEASON:4,CHART_TYPE_LINE_RETURN:5,CHART_TYPE_STACKED_COLUMN:6,CHART_TYPE_STACKED_BAR:60,CHART_TYPE_LINE_RANGE:7,CHART_TYPE_CYCLE:9,isMobile:void 0!==window.matchMedia&&window.matchMedia("(max-width: 1024px)").matches,isPhone:void 0!==window.matchMedia&&window.matchMedia("(max-width: 480px)").matches,datePattern:/\d{4}-\d{2}-\d{2}/,dateRanges:{"1w":App.__("etf:1w"),"1m":App.__("etf:1m"),"3m":App.__("etf:3m"),"6m":App.__("etf:6m"),ytd:App.__("etf:ytd"),"1y":App.__("etf:1y"),"2y":App.__("etf:2y"),"3y":App.__("etf:3y"),"5y":App.__("etf:5y"),"10y":App.__("etf:10y")},unitOptions:{"":{name:"Number",val:"",suffix:"",basis:1},k:{name:"Thousands",val:"k",suffix:"k",basis:1e3},"10k":{name:"10 Thousands",val:"10k",suffix:"0k",basis:1e4},m:{name:"Millions",val:"m",suffix:"m",basis:1e6},"10m":{name:"10 Millions",val:"10m",suffix:"0m",basis:1e7},"100m":{name:"100 Millions",val:"100m",suffix:"00m",basis:1e8},b:{name:"Billions",val:"b",suffix:"b",basis:1e9},t:{name:"Trillions",val:"t",suffix:"t",basis:1e12},pct:{name:"Percent",val:"pct",suffix:"%",basis:1},pctp:{name:"Percentage Point",val:"pctp",suffix:"pp",basis:1},idx:{name:"Index",val:"idx",suffix:"",basis:1},bp:{name:"Basis Point",val:"bp",suffix:"",basis:1}},rangeSelectors:[{type:"all",text:"All"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"year",count:2,text:"2y"},{type:"year",count:3,text:"3y"},{type:"year",count:5,text:"5y"},{type:"year",count:10,text:"10y"}],opnOptions:{lin:App.__("builder:opn:lin"),linmc:App.__("builder:opn:linmc"),chg:App.__("builder:opn:chg"),ch1:App.__("builder:opn:ch1"),pch:App.__("builder:opn:pch"),pchmc:App.__("builder:opn:pchmc"),ypchmm:App.__("builder:opn:ypchmm"),pc1:App.__("builder:opn:pc1"),pc1mc:App.__("builder:opn:pc1mc"),mva:App.__("builder:opn:mva"),shift:App.__("builder:opn:shift"),drawdown:App.__("builder:opn:drawdown"),rebound:App.__("builder:opn:rebound"),mvz:App.__("builder:opn:mvz"),mvstd:App.__("builder:opn:mvstd"),log:App.__("builder:opn:log"),bias:App.__("builder:opn:bias"),base:App.__("builder:opn:base"),reciprocal:App.__("builder:opn:reciprocal"),accu_return:App.__("builder:opn:accu_return")},freqOptions:{Y:App.__("builder:freq:Y"),H:App.__("builder:freq:H"),Q:App.__("builder:freq:Q"),M:App.__("builder:freq:M"),W:App.__("builder:freq:W"),D:App.__("builder:freq:D")},aggnOptions:{avg:App.__("builder:aggn:avg"),sum:App.__("builder:aggn:sum"),eop:App.__("builder:aggn:eop")},colorOptions:["#3bafda","#e9573f","#f6bb42","#70ca63","#7d5b4f","#3b3f4f","#926dde","#57c7d4","#f44c87","#BC94AC","#184E74","#026352","#C1C286","#AA2906","#A5FFD6","#84DCC6","#FF99AC","#17C3B2","#D68C45","#6F2DBD","#F7AEF8","#B388EB","#8093F1","#72DDF7","#94D2BD","#E9D8A6","#EE9B00","#FFEE32","#37bc9b"],recPlotBands:[{color:"rgba(231,231,231,0.5)",from:Date.UTC(1902,8,1),to:Date.UTC(1904,7,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1907,4,1),to:Date.UTC(1908,5,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1910,0,1),to:Date.UTC(1912,0,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1913,0,1),to:Date.UTC(1914,11,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1918,7,1),to:Date.UTC(1919,2,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1920,0,1),to:Date.UTC(1921,6,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1923,4,1),to:Date.UTC(1924,6,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1926,9,1),to:Date.UTC(1927,10,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1929,7,1),to:Date.UTC(1933,2,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1937,4,1),to:Date.UTC(1938,5,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1945,1,1),to:Date.UTC(1945,9,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1948,10,1),to:Date.UTC(1949,9,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1953,6,1),to:Date.UTC(1954,3,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1957,7,1),to:Date.UTC(1958,3,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1960,3,1),to:Date.UTC(1961,1,28)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1969,11,1),to:Date.UTC(1970,10,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1973,10,1),to:Date.UTC(1975,2,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1980,0,1),to:Date.UTC(1980,6,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1981,6,1),to:Date.UTC(1982,10,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(1990,6,1),to:Date.UTC(1991,2,31)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(2001,2,1),to:Date.UTC(2001,10,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(2007,11,1),to:Date.UTC(2009,5,30)},{color:"rgba(231,231,231,0.5)",from:Date.UTC(2020,1,1),to:Date.UTC(2020,3,31)}],initOptions(){if(void 0!==window.Highcharts&&!document.body.classList.contains("no-highcharts-opts")){let t,e,i,a,s,r,n,l,c,h,p,d,f;h={type:"image/png",chartOptions:{rangeSelector:{enabled:!1},navigator:{enabled:!1},scrollbar:{enabled:!1}},buttons:{contextButton:{enabled:!1}}},l={buttonOptions:{enabled:!1}},c={enabled:!1},t={enabled:!1},e={numericSymbols:["K","M","B","T","P","E"],thousandsSep:","},a={line:{lineWidth:2,marker:{enabled:!1},states:{inactive:{enabled:!1},hover:{enabled:!1}}}},n={shared:!0,valueDecimals:2,followPointer:!0},r={text:"MacroMicro.me｜ MacroMicro",style:{color:"#666666",fontSize:"12px"}},this.isPhone?(i={backgroundColor:"transparent",animation:!1},s={style:{color:"#333333",fontSize:"13px",fontWeight:"normal"}}):(i={backgroundColor:"transparent",style:{fontFamily:'-apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'}},s=-1!==navigator.userAgent.indexOf("Windows")?{style:{color:"#333333",fontSize:"16px",fontWeight:"bold"}}:{style:{color:"#333333",fontSize:"16px",fontWeight:"normal"}}),i.zooming={mouseWheel:{enabled:!1}},p={labels:{style:{fontSize:"11px",color:"#666"}},title:{style:{fontSize:"12px",color:"#666"}},lineColor:"#d8d8d8",tickColor:"#d8d8d8"},d={labels:{style:{fontSize:"11px",color:"#666"}},title:{style:{fontSize:"12px",color:"#666"}}},f=-1!==navigator.userAgent.indexOf("Windows")?{itemStyle:{color:"#000000",fontWeight:"bold",fontSize:"14px"}}:{itemStyle:{color:"#000000",fontSize:"14px"}},o().setOptions({credits:t,lang:e,chart:i,plotOptions:a,title:s,subtitle:r,tooltip:n,navigation:l,exporting:h,accessibility:c,xAxis:p,yAxis:d,legend:f,colors:this.colorOptions})}},getRGBA(t,e){t=t.replace("#","");let i=parseInt(t,16);return"rgba("+(i>>16&255)+", "+(i>>8&255)+", "+(255&i)+", "+e+")"},addCustomDateFormats(){o().dateFormats.q=function(t){let e=new Date(t);return(Math.floor(e.getUTCMonth()/3)+1).toString()},o().dateFormats.c=function(t){let e=new Date(t);return(Math.floor(e.getUTCMonth()/6)+1).toString()}},exportSettings:{1:{exportingOptions:{sourceWidth:960,sourceHeight:540,filename:"mm-chart-960x540"},chartOptions:{chart:{backgroundColor:"#fff"},title:{style:{fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"bold":"normal",fontSize:"24px"}},subtitle:{style:{fontWeight:"normal",fontSize:"18px"}},xAxis:{labels:{style:{fontSize:"14px",color:"#666"}},title:{style:{fontSize:"14px",color:"#666"}}},yAxis:[{labels:{style:{fontSize:"14px",color:"#666"}},title:{style:{fontSize:"14px",color:"#666"}}}],legend:{itemStyle:{fontSize:"20px",fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"900":"500"}}}},2:{exportingOptions:{sourceWidth:975,sourceHeight:635,filename:"mm-chart-975x635"},chartOptions:{chart:{backgroundColor:"#fff",marginLeft:null,marginRight:null},title:{style:{fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"bold":"normal",fontSize:"26px"}},subtitle:{style:{fontWeight:"normal",fontSize:"20px"}},xAxis:{labels:{style:{fontSize:"17px",color:"#666"}},title:{style:{fontSize:"17px",color:"#666"}}},yAxis:[{labels:{style:{fontSize:"17px",color:"#666"}},title:{style:{fontSize:"17px",color:"#666"}}}],legend:{itemStyle:{fontSize:"24px",fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"900":"500"}}}},3:{exportingOptions:{sourceWidth:800,sourceHeight:800,filename:"mm-chart-800x800"},chartOptions:{chart:{backgroundColor:"#fff",marginLeft:null,marginRight:null},title:{style:{fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"bold":"normal",fontSize:"26px"}},subtitle:{style:{fontWeight:"normal",fontSize:"20px"}},xAxis:{labels:{style:{fontSize:"18px",color:"#666"}},title:{style:{fontSize:"18px",color:"#666"}}},yAxis:(()=>{let t={labels:{style:{fontSize:"18px",color:"#666"}},title:{style:{fontSize:"18px",color:"#666"}}},e=[];for(let i=0;i<10;i++)e.push(t);return e})(),legend:{itemStyle:{fontSize:"24px",fontWeight:-1!==navigator.userAgent.indexOf("Windows")?"900":"500"}}}}},getDefaultCnf:function(t=2,e="",i=""){let a="MacroMicro.me";return a+=""!==i?" | "+i:" | MacroMicro",{tooltip:{valueDecimals:t},exporting:{type:"image/png",chartOptions:{rangeSelector:{enabled:!1}},buttons:{contextButton:{enabled:!1}}},title:{text:e},subtitle:{text:a},xAxis:{plotBands:this.recPlotBands,crosshair:!0,type:"datetime"},yAxis:[],series:[],alignTicks:!1,chart:{events:{}},credits:{enabled:!1}}},appendSourceText:t=>(!0===window.hideWatermark?t.chart.events={load:function(){let t=this.chartWidth,e=this.chartHeight,i=App.__("chart:export:source"),a="en"!==App.lang?t-180:t-110;this.renderer.text(i,a,e-5).css({color:"#76838f",fontSize:"11px"}).add()}}:t.chart.hasOwnProperty("events")&&t.chart.events.hasOwnProperty("load")&&delete t.chart.events.load,t),genNewestValuesLabel(t,e=!1){if(e){let t=document.querySelector(".hc-newest-values");t&&t.parentNode.removeChild(t)}if(0===t.series.filter((function(t){return!0===t.visible&&t.data.length>0})).length||0===t.series.length)return;let i=t.series.map((function(t){if(t.visible)return'<span style="color: '+t.color+';">&#9679;</span> '+t.name+": "+t.data[t.data.length-1].y.toFixed(2)}));t.renderer.label(i.join("<br>"),t.plotLeft+5,t.plotTop+5).attr({fill:"rgba(255,255,255, 1)",padding:8,r:2,zIndex:6,stroke:"rgb(102,102,102)"}).addClass("hc-newest-values").css({color:"rgb(66,66,66)",fontSize:"0.8rem"}).add()},appendWaterMark(t){if(!t||t.container.parentElement.classList.contains("no-watermark"))return;let e,i,a,s;t.chartWidth<500?(e=100,i=100,a=200,s=t.container.parentElement.classList.contains("dnb-watermark")?70:35,t.userOptions.chart&&"column"===t.userOptions.chart.type&&(e=200)):(e=120,i=120,a=t.container.parentElement.classList.contains("dnb-watermark")?150:300,s=t.container.parentElement.classList.contains("dnb-watermark")?68:50,t.userOptions.chart&&"column"===t.userOptions.chart.type&&(e=t.chartWidth/5*3)),"showNewestValues"in window&&window.showNewestValues&&(i=t.plotHeight);let r=t.container.parentElement.classList.contains("dnb-watermark")?location.origin+"/img/ui/dnb-mm-logo.png":location.origin+"/img/ui/chart-watermark.png";t.renderer.image(r,e,i,a,s).attr({zIndex:0,opacity:1}).add()},getDateByFreq:function(t,e){let i={"01":"Q1","04":"Q2","07":"Q3",10:"Q4"},a=e.split("-");return i.hasOwnProperty(a[1])&&"Q"===t?a[0]+"-"+i[a[1]]:"Y"===t?a[0]:"M"===t?a[0]+"-"+a[1]:e},getYLabel(t,e,i,a="name",s=!1){var r;-1===["suffix","name"].indexOf(a)&&(a="name"),"string"==typeof t&&(t=parseInt(t)),e.hasOwnProperty("unifyYAxisIdx")&&null!==e.unifyYAxisIdx&&void 0!==e.seriesConfigs[e.unifyYAxisIdx]&&(i=e.unifyYAxisIdx);let n=e.seriesConfigs[i];if(n.hasOwnProperty("unitlabel")&&n.unitlabel)return n.unitlabel;let o=[],l=["bias","drawdown","rebound","pch","pc1","pchmc","pc1mc","ypchmm","accu_return"],c=["linmc","mvz","mvstd","log","base","reciprocal"],h=["ch1","chg","mva","shift"];if(n.hasOwnProperty("opn")&&"lin"!==n.opn){let t="";-1!==l.indexOf(n.opn)?t="pct":-1!==c.indexOf(n.opn)?t="":-1!==h.indexOf(n.opn)&&n.u in this.unitOptions&&(t=n.u),o.push(this.unitOptions[t][a])}else if(""!==n.arithmetic){let t;if(n.arithmetic.includes("*")||n.arithmetic.includes("/"))t="";else{let e=!0;for(let t=0;t<n.stats.length;t++)if(0!==t&&n.stats[t].u!==n.stats[t-1].u){e=!1;break}t=e?n.stats[0].u:""}o.push(this.unitOptions[t][a])}else if(-1!==[this.CHART_TYPE_QUOTE_BAR,this.CHART_TYPE_QUOTE_COLUMN].indexOf(t)){let t="pch"===(null!=(r=e.return_opn)?r:"pch")?"pct":"";o.push(this.unitOptions[t][a])}else t===this.CHART_TYPE_SEASON&&"ratio"===n.season_mode?o.push(this.unitOptions.pct[a]):n.hasOwnProperty("u")&&this.unitOptions.hasOwnProperty(n.u)?o.push(this.unitOptions[n.u][a]):o.push(this.unitOptions[""][a]);if(!s){let t;if(""===n.arithmetic)t=n.stats[0].hasOwnProperty("currency")?n.stats[0].currency:"";else{let e=!0;for(let t=0;t<n.stats.length;t++)if(0!==t&&n.stats[t].currency!==n.stats[t-1].currency){e=!1;break}t=e?n.stats[0].currency:""}t&&o.push(t.toUpperCase())}return o.length>0?"suffix"===a?o[0]:o.join(", "):this.unitOptions[""][a]},drawChart(t,e,i,a=!0){if(this.cleanOldMinMaxPlotLines(),0===i.length)return console.log("如果無任何數據序列，表示清空圖層"),document.getElementById(t).innerHTML="",null;let s,r=document.getElementById(t);if(null===r||null===e)return null;if(r.classList.contains("loaded")&&a)return null;if(e.type===this.CHART_TYPE_LINE_RETURN&&""===e.date_range){let t=i[0][0][0];for(let e=0;e<i.length;e++)(i[e][0][0]>t||1===i.length)&&(t=i[e][0][0]);e.date_start=t}if(e.type===this.CHART_TYPE_CYCLE){let e=document.getElementById(`${t}-cyclic-chart-toolbar`);null!==e&&e.remove()}switch("string"==typeof e.type?parseInt(e.type):e.type){case this.CHART_TYPE_LINE:case this.CHART_TYPE_LINE_STOCK:case this.CHART_TYPE_LINE_RETURN:case this.CHART_TYPE_LINE_RANGE:s=new c(t,e,i).draw();break;case this.CHART_TYPE_RECENT_BAR:case this.CHART_TYPE_RECENT_COLUMN:s=new h(t,e,i).draw();break;case this.CHART_TYPE_STACKED_COLUMN:case this.CHART_TYPE_STACKED_BAR:s=new p(t,e,i).draw();break;case this.CHART_TYPE_QUOTE_COLUMN:s=new d(t,e,i).draw();break;case this.CHART_TYPE_QUOTE_BAR:s=new f(t,e,i).draw();break;case this.CHART_TYPE_SEASON:s=new u(t,e,i).draw();break;case this.CHART_TYPE_CYCLE:s=new g(t,e,i).draw()}return window.hasOwnProperty("maxMinOpt")&&this.appendMaxMinLines(s,"All"),r.classList.add("loaded"),s},cleanOldMinMaxPlotLines(){if(window.hasOwnProperty("mm-max-plotline")&&window["mm-max-plotline"]instanceof o().PlotLineOrBand){let t=window["mm-max-plotline"].axis;t instanceof o().Axis&&(t.removePlotLine("mm-max-plotline"),t.removePlotLine("mm-min-plotline")),delete window["mm-max-plotline"],delete window["mm-min-plotline"]}},appendMaxMinLines(t,e="All"){let i=window.hasOwnProperty("maxMinOpt")?window.maxMinOpt:null;if(!(t instanceof o().Chart))return;if(this.cleanOldMinMaxPlotLines(),null===i||0===t.series.length)return;let a=0;for(let e=0;e<t.series.length;e++){let i=t.series[e].data.length,s=t.series[e].data[i-1];s.x>a&&(a=s.x)}let s,r,n=t.series[i],l=-1/0,c=1/0;if(!n||0===n.data.length)return;let h=new Date(a),p=n.data.length;if("All"!==e)switch(e){case"6m":h.setMonth(h.getMonth()-6);break;case"YTD":h.setMonth(0,1);break;case"1y":h.setFullYear(h.getFullYear()-1);break;case"2y":h.setFullYear(h.getFullYear()-2);break;case"3y":h.setFullYear(h.getFullYear()-3);break;case"5y":h.setFullYear(h.getFullYear()-5);break;case"10y":h.setFullYear(h.getFullYear()-10)}let d=h.getTime();for(let t=0;t<p;t++)"All"!==e&&n.data[t].x<d||(n.data[t].y<c&&(c=n.data[t].y,r=n.data[t].x),n.data[t].y>l&&(l=n.data[t].y,s=n.data[t].x));let f=new Date(s),u=new Date(r);window["mm-max-plotline"]=n.yAxis.addPlotLine({id:"mm-max-plotline",color:n.color.toString(),width:2,value:l,zIndex:5,dashStyle:"Dash",label:{text:"Max: "+l.toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})+" ("+f.toLocaleDateString("sv")+")",useHTML:!0,style:{backgroundColor:"white",padding:"3px",fontWeight:"bold",border:"1px solid #eee"},align:"right",verticalAlign:"top",y:-15}}),window["mm-min-plotline"]=n.yAxis.addPlotLine({id:"mm-min-plotline",color:n.color.toString(),width:2,value:c,zIndex:5,dashStyle:"Dash",label:{text:"Min: "+c.toLocaleString("en-US",{maximumFractionDigits:2,minimumFractionDigits:2})+" ("+u.toLocaleDateString("sv")+")",useHTML:!0,style:{backgroundColor:"white",padding:"3px",fontWeight:"bold",border:"1px solid #eee"},align:"right",verticalAlign:"top",y:15}})}};m.initOptions(),o()&&o().dateFormats&&m.addCustomDateFormats();var b=m;return(s=a.O(s)).default}()}));